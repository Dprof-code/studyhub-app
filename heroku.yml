build:
  docker:
    web: Dockerfile
  config:
    GEMINI_API_KEY: $GEMINI_API_KEY
    GOOGLE_CLOUD_PROJECT_ID: $GOOGLE_CLOUD_PROJECT_ID
    DATABASE_URL: $DATABASE_URL
    NEXTAUTH_SECRET: $NEXTAUTH_SECRET
    NEXTAUTH_URL: $NEXTAUTH_URL
    GOOGLE_CLIENT_ID: $GOOGLE_CLIENT_ID
    GOOGLE_CLIENT_SECRET: $GOOGLE_CLIENT_SECRET
release:
  command:
    - npx prisma migrate deploy
  image: web
run:
  web: node_modules/.bin/ts-node --project tsconfig.server.json server.ts